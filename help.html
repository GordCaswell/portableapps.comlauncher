<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
	<head>
		<title>PortableApps.com Launcher Help</title>
		<link rel="alternate" type="application/rss+xml" title="PortableApps.com" href="http://portableapps.com/feeds/general">
		<link rel="SHORTCUT ICON" href="Other/Help/images/favicon.ico">
		<style>
			body {
				margin: 20px;
				background: #e6e8ea none repeat scroll 0% 50%;
				font-family: Verdana,Arial,Helvetica,sans-serif;
				font-size: 76%;
				color: #000000;
				text-align: center;
			}
			pre {
				border: 1px dotted #808080;
				padding: 10px;
				background-color: #e6e8ea;
				-moz-border-radius-topleft: 12px;
				-moz-border-radius-topright: 12px;
				-moz-border-radius-bottomright: 12px;
				-moz-border-radius-bottomleft: 12px;
			}
			a {
				color: #b31616;
				font-weight: bold;
			}
			a:link {
			}
			a:visited {
			}
			a:active {
			}
			a:hover {
				color: red;
			}
			h1, h2, h3, h4, h5, h6 {
				font-family: Arial,sans-serif;
				font-weight: bold;
			}
			h1 {
				border-bottom: 1px solid silver;
				color: #b31616;
				font-weight: bold;
				letter-spacing: -2px;
				font-size: 2.2em;
				padding-bottom: 5px;
			}
			h2 {
				border-bottom: 1px solid silver;
				font-size: 1.5em;
				padding-bottom: 3px;
				clear: both;
			}
			h3 {
				font-size: 1.2em;
			}
			h4 {
				font-size: 1.1em;
			}
			h5 {
				font-size: 1em;
			}
			h6 {
				font-size: 0.8em;
			}
			img {
				border: none;
			}
			ol, ul, li {
				font-size: 1em;
			}
			p, table, tr, td, th {
				font-size: 1em;
			}
			pre {
				font-size: 1em;
			}
			strong, b {
				font-weight: bold;
			}
			table, tr, td {
				font-size: 1em;
				border-collapse: collapse;
			}
			td, th {
				border: 1px solid #aaaaaa;
				padding: 3px;
				border-collapse: collapse;
			}
			th {
				background: #3667a8 none repeat scroll 0% 50%;
				color: white;
			}
			ol ol {
				list-style-type: lower-alpha;
			}
			.content {
				border-left: 1px solid Black;
				border-right: 1px solid Black;
				padding: 12px 30px;
				text-align: left;
				margin-left: auto;
				margin-right: auto;
				width: 780px;
				background-color: #ffffff;
				line-height: 150%;
			}
			.logo {
				border-left: 1px solid black;
				border-right: 1px solid black;
				background: #ffffff url(Other/Help/images/help_background_header.png) repeat-x;
				width: 840px;
				margin-top: 20px;
				margin-left: auto;
				margin-right: auto;
				text-align: left;
			}
			.footer {
				border-left: 1px solid black;
				border-right: 1px solid black;
				background: #ffffff url(Other/Help/images/help_background_footer.png) repeat-x scroll 0% 50%;
				width: 840px;
				height: 16px;
				margin-left: auto;
				margin-right: auto;
				text-align: left;
			}
			.logo img {
				border: none;
				padding-left: 0px;
				position: relative;
				top: -4px;
			}
			* html .content {
				width: 760px;
			}
			* html .logo, * html .footer {
				width: 820px;
			}
			.content h1 {
				margin: 0px;
			}
			h1.hastagline {
				border: none;
			}
			h2.tagline {
				color: #747673;
				clear: none;
				margin-top: 0em;
			}
			pre, .ini-head, .ini-key, .ini-value {
				font-family: Courier New,Courier,monospace;
			}
			.ini-head, .ini-head:hover {
				font-weight: bold;
				color: #b31616;
			}
			.ini-key, .ini-key:hover {
				font-weight: normal;
				color: #0000c0;
			}
			.ini-value, .ini-value:hover {
				font-weight: normal;
				color: #008000;
			}
			.ini-default {
				font-weight: bold;
				text-decoration: underline;
			}
			pre a:link, pre a:visited {
				text-decoration: none;
			}
			pre a:link:hover, pre a:visited:hover, pre a:link:active, pre a:visited:active {
				text-decoration: underline;
			}
			@media print {
				body, .content { margin: 0;
					padding: 0;
				}
				.navigation, .locator, .footer a, .message, .footer-links {
					display: none;
				}
				.footer, .content, .header {
					border: none;
				}
				a {
					text-decoration: none;
					font-weight: normal;
					color: black;
				}
			}
		</style>
	</head>
<body>
<div class="logo"><a href="http://portableapps.com/"><img src="Other/Help/images/help_logo_top.png" alt="PortableApps.com - Your Digital Life, Anywhere" height="47" width="229"></a></div>
<div class="content">
<h1 class="hastagline">PortableApps.com Launcher Manual</h1>
<div class="tagline">
<h2 class="tagline">your PAL in making portable apps</h2>
</div>
<p>The PortableApps.com Launcher is a generic launcher, configured by the developer with a simple INI file to make applications into <a href="http://portableapps.com/about/what_is_a_portable_app">portable apps</a>. <a href="http://portableapps.com">Learn more about PortableApps.com...</a></p>
<p><a href="http://portableapps.com/donate"><img src="Other/Help/images/donation_button.png" alt="Make a Donation" align="top" border="0" height="23" width="110"></a> - Support PortableApps.com's Hosting and Development</p>
<p><a href="http://PortableApps.com/development">Go to the PortableApps.com Launcher Homepage &gt;&gt;</a></p>
<p><a href="http://PortableApps.com/">Get portable apps at PortableApps.com</a></p>
<p>This software is OSI Certified Open Source Software. OSI Certified is a certification mark of the Open Source Initiative.</p>
<h2>Documentation</h2>
<p>The file name of the PortableApps.com Launcher, PortableApps.comLauncher.exe, should never be changed.</p>
<p>The PortableApps.com Launcher gets its splash screen from App\AppInfo\splash.jpg. For a development test release, this should be <a href="http://portableapps.com/files/images/development/SplashDevelopmentTestRelease.jpg">the black and white PortableApps.com Development Test Release splash screen</a>. When an application goes on to Pre-Release or official, it gets its own splash screen.</p>
<p>The PortableApps.com Launcher depends on one file for its information and portablization: App\AppInfo\launcher.ini. This often quite complex file is the backbone of the portability which the PortableApps.com Launcher provides. It must be correctly configured to cover everything which the application uses. <strong>Only developers should ever modify the launcher INI file, as improper modifications may cause system damage, lose data or cause data to be left behind.</strong></p>
<p>Here is the format for the launcher INI file. Where there is a list of possible values, the default value is bold.</p>
<pre><a href="#Launch" class="ini-head">[Launch]</a>
<a href="#Launch:AppName" class="ini-key">AppName=</a><span class="ini-value">App Name</span>
<a href="#Launch:ProgramExecutable" class="ini-key">ProgramExecutable=</a><span class="ini-value">AppName\AppName.exe</span>
<a href="#Launch:DefaultCommandLineArguments" class="ini-key">DefaultCommandLineArguments=</a><span class="ini-value">--data-directory=%DATADIR%\settings</span>
<a href="#Launch:SetOutPath" class="ini-key">SetOutPath=</a><span class="ini-value">%APPDIR%\AppName</span>
<a href="#Launch:RunAsAdmin" class="ini-key">RunAsAdmin=</a><span class="ini-value">force</span> / <span class="ini-value">try</span> / <span class="ini-default">none</span>
<a href="#Launch:AssignContainedTempDirectory" class="ini-key">AssignContainedTempDirectory=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
<a href="#Launch:SinglePortableAppInstance" class="ini-key">SinglePortableAppInstance=</a><span class="ini-value">true</span> / <span class="ini-value ini-default">false</span>
<a href="#Launch:SingleAppInstance" class="ini-key">SingleAppInstance=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
<a href="#Launch:CloseEXE" class="ini-key">CloseEXE=</a><span class="ini-value">another_optional_app.exe</span>
<a href="#Launch:WaitForProgram" class="ini-key">WaitForProgram=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
<a href="#Launch:WaitForOtherInstances" class="ini-key">WaitForOtherInstances=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
<a href="#Launch:WaitForEXE" class="ini-key">WaitForEXE=</a><span class="ini-value">another_optional_app.exe</span>
<a href="#Launch:RefreshShellIcons" class="ini-key">RefreshShellIcons=</a><span class="ini-value">before</span> / <span class="ini-value">after</span> / <span class="ini-value">both</span> / <span class="ini-default">none</span>
<a href="#Launch:HideCommandLineWindow" class="ini-key">HideCommandLineWindow=</a><span class="ini-value">true</span> / <span class="ini-value ini-default">false</span>

<a href="#Activate" class="ini-head">[Activate]</a>
<a href="#Activate:Registry" class="ini-key">Registry=</a><span class="ini-value">true</span> / <span class="ini-value ini-default">false</span>
<a href="#Activate:Java" class="ini-key">Java=</a><span class="ini-value">find</span> / <span class="ini-value">require</span> / <span class="ini-default">none</span>

<a href="#LiveMode" class="ini-head">[LiveMode]</a>
<a href="#LiveMode:CopyApp" class="ini-key">CopyApp=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
<!--<a href="#CopyData" class="ini-key">CopyData=</a><span class="ini-value ini-default">true</span> / <span class="ini-value">false</span>
-->
<a href="#RegistryKeys" class="ini-head">[RegistryKeys]</a>
<span class="ini-key">appname_portable=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub\lisher\AppName</span>

<a href="#RegistryValueWrite" class="ini-head">[RegistryValueWrite]</a>
<span class="ini-key">HKEY_CURRENT_USER\Software\Pub\lisher\AppName\Value=</span><span class="ini-value">REG_DWORD:0</span>

<a href="#RegistryCleanupIfEmpty" class="ini-head">[RegistryCleanupIfEmpty]</a>
<span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub\lisher</span>
<span class="ini-key">2=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub</span>

<a href="#RegistryCleanupForce" class="ini-head">[RegistryCleanupForce]</a>
<span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub\lisher</span>
<span class="ini-key">2=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub</span>

<a href="#RegistryValueBackupDelete" class="ini-head">[RegistryValueBackupDelete]</a>
<span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Pub\lisher\AppName\Value</span>

<a href="#FileWriteConfigWrite" class="ini-head">[FileWriteConfigWrite]</a>
<span class="ini-key">1File=</span><span class="ini-value">%DATADIR%\settings\data.conf</span>
<span class="ini-key">1Entry=</span><span class="ini-value">&lt;config id="home_directory"&gt;</span>
<span class="ini-key">1Value=</span><span class="ini-value">%/PORTABLEAPPSDOCUMENTSDIR%&lt;/config&gt;</span>

<a href="#FileWriteINI" class="ini-head">[FileWriteINI]</a>
<span class="ini-key">1File=</span><span class="ini-value">%DATADIR%\settings\data.conf</span>
<span class="ini-key">1Section=</span><span class="ini-value">Paths</span>
<span class="ini-key">1Key=</span><span class="ini-value">home_directory</span>
<span class="ini-key">1Value=</span><span class="ini-value">%PORTABLEAPPSDOCUMENTSDIR%</span>

<a href="#FilesMove" class="ini-head">[FilesMove]</a>
<span class="ini-key">settings\file.txt=</span><span class="ini-value">%APPDIR%\AppName</span>

<a href="#DirectoriesMove" class="ini-head">[DirectoriesMove]</a>
<span class="ini-key">settings=</span><span class="ini-value">%APPDATA%\Pub\lisher\AppName</span>

<a href="#DirectoriesCleanupIfEmpty" class="ini-head">[DirectoriesCleanupIfEmpty]</a>
<span class="ini-key">1=</span><span class="ini-value">%APPDATA%\Pub\lisher</span>
<span class="ini-key">2=</span><span class="ini-value">%APPDATA%\Pub</span>

<a href="#DirectoriesCleanupForce" class="ini-head">[DirectoriesCleanupForce]</a>
<span class="ini-key">1=</span><span class="ini-value">%APPDATA%\Pub\lisher</span>
<span class="ini-key">2=</span><span class="ini-value">%APPDATA%\Pub</span>

<a href="#FileDriveLetterUpdate" class="ini-head">[FileDriveLetterUpdate]</a>
<span class="ini-key">Backslash1=</span><span class="ini-value">%DATADIR%\settings\settings.conf</span>
<span class="ini-key">Forwardslash1=</span><span class="ini-value">%DATADIR%\settings\settings.conf</span>

<a href="#Environment" class="ini-head">[Environment]</a>
<span class="ini-key">PATH=</span><span class="ini-value">%APPDIR%\AppName;{&amp;}</span>
<span class="ini-key">HOME=</span><span class="ini-value">%DATADIR%\settings</span>

<a href="#Service" class="ini-head">[Service<em>N</em>]</a>
<a href="#Service:Name" class="ini-key">Name=</a><span class="ini-value">ServiceName</span>
<a href="#Service:Path" class="ini-key">Path=</a><span class="ini-value">%APPDIR%\AppName\service.exe</span>
<a href="#Service:Type" class="ini-key">Type=</a><span class="ini-value ini-default">service</span> / <span class="ini-value">driver-kernel</span> / <span class="ini-value">driver-file-system</span>
<a href="#Service:User" class="ini-key">User=</a><span class="ini-value">LocalService</span> / <span class="ini-value">NetworkService</span>  / <span class="ini-default">none</span>
<a href="#Service:Display" class="ini-key">Display=</a><span class="ini-value">Display name</span>
<a href="#Service:Dependencies" class="ini-key">Dependencies=</a><span class="ini-value">Foo/Bar</span>
<a href="#Service:Description" class="ini-key">Description=</a><span class="ini-value">Long description of the service</span>
<a href="#Service:IfExists" class="ini-key">IfExists=</a><span class="ini-value ini-default">skip</span> / <span class="ini-value">replace</span>
</pre>

<h3>Explanation of launcher INI options</h3>
<p>There are some definite entries, which specify fixed values, and some arbitrary sections and values for custom entries. First here are the definite entries.</p>
<ul>
	<li id="Launch"><span class="ini-head">[Launch]</span><ul>
		<li id="Launch:AppName"><span class="ini-key">AppName</span><br />This is used for the error message box provided to the user if there is already a copy of the application running. It should be like this: "Mozilla Firefox", or "Code::Blocks", or "7-Zip". In theory this field should never be used, as it defaults to the long name specified in appinfo.ini minus the string " Portable" or ", Portable Edition" at the end. Please consider changing the value in appinfo.ini rather than using this field.</li>
		<li id="Launch:ProgramExecutable"><span class="ini-key">ProgramExecutable</span><br />This is the path to the application to launch, relative to the "App" directory. Generally, it should have no spaces or characters which cannot go in file names, and should be like this: "Firefox\firefox.exe", or "CodeBlocks\codeblocks.exe", or "7-Zip\7zFM.exe", or "gimp\bin\gimp-2.6.exe".</li>
		<li id="Launch:DefaultCommandLineArguments"><span class="ini-key">DefaultCommandLineArguments</span><br />This is used as command-line arguments to always pass to the executable, for example "--data-directory=%DATADIR%\settings --music-directory=%PORTABLEAPPSMUSICDIR%". <strong>Substitutions apply.</strong></li>
		<li id="Launch:SetOutPath"><span class="ini-key">SetOutPath</span><br />This is used to change the working directory to start the application in. Only use this if absolutely necessary, as it will (at the moment) mess up relative files passed through the command-line. Example (normally all it'll ever need): "%APPDIR%\AppName". <strong>Substitutions apply.</strong></li>
		<li id="Launch:RunAsAdmin"><span class="ini-key">RunAsAdmin</span> (values: <span class="ini-value">force</span>, <span class="ini-value">try</span> or <span class="ini-default">none</span>)<br />If the application requires administrative privileges (for example for services or drivers, or if settings are stored in HKEY_LOCAL_MACHINE), set this value to <span class="ini-value">force</span>. If some features require administrative privileges, but are not essential, set this value to <span class="ini-value">try</span>. Otherwise, leave this value unset.</li>
		<li id="Launch:AssignContainedTempDirectory"><span class="ini-key">AssignContainedTempDirectory</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />If the application writes things to the TEMP directory and does not always clean them up, specify "true" here, and it will be given a subdirectory (in the format %TEMP%\AppNamePortableTemp) as its TEMP directory, which will be removed after the application is closed, thus not leaving anything behind. If WaitForProgram is set to false, this will still work, but it may be slower. The TEMP directory will be set to go in Data\temp, so that it is still functional.  This may slow down some apps, and may also clutter up the running device.  Additionally, this directory will not be deleted upon program completion, but it will be the next time the application is started.</li>
		<li id="Launch:SinglePortableAppInstance"><span class="ini-key">SinglePortableAppInstance</span> (values: <span class="ini-value">true</span> or <span class="ini-value ini-default">false</span>)<br />If you only wish one instance of the portable version of the application to be run, set this to true. If it is set to true, if the launcher is started while another copy of the launcher is already running, the second instance will abort silently. If you wish to prevent a local and portable version of the application from running concurrently, look at SingleAppInstance.</li>
		<li id="Launch:SingleAppInstance"><span class="ini-key">SingleAppInstance</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />If you only wish one instance of the application, portable or local, to be run, set this to true or omit it. If it is set to true, if the launcher is started while another copy of the application, portable or local, is already running, it will abort with an error message.</li>
		<li id="Launch:CloseEXE"><span class="ini-key">CloseEXE</span><br />If you wish to specify another executable to require to be closed before the portable application is started than the ProgramExecutable entry, enter the file name in here, e.g. "inkview.exe" for Inkscape.</li>
		<li id="Launch:WaitForProgram"><span class="ini-key">WaitForProgram</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />If you don't need the launcher to wait for the conclusion of the application, set this to false. Note that you should only do this if you do not have registry entries to handle or files to move, for example if you can redirect all settings with command-line arguments or environment variables.</li>
		<li id="Launch:WaitForOtherInstances"><span class="ini-key">WaitForOtherInstances</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />If the application is single-instance (i.e. if you run another copy of it it won't run but will activate the first one), and the application can't restart itself, you can set this to false. If the application can restart itself at all, e.g. Firefox can, DO NOT set this to false, or else clean-up will start while the application is still running, which won't be good for it.</li>
		<li id="Launch:WaitForEXE"><span class="ini-key">WaitForEXE</span><br />If the program that you run is a launcher program which launches another executable, and you need to wait for that as well as (or instead of) the original program, specify its file name here.</li>
		<li id="Launch:RefreshShellIcons"><span class="ini-key">RefreshShellIcons</span> (values: <span class="ini-value">before</span>, <span class="ini-value">after</span>, <span class="ini-value">both</span> or <span class="ini-default">none</span>)<br />If the application does any registering of file type extensions which you handle or clean up, to make the new icon appear or to stop the portable one appearing, set this to one of the values. If it is just cleaning up at the end, <span class="ini-value">after</span> should be enough, but if you handle it with a <span class="ini-head">RegistryKeys</span> value, you will need <span class="ini-value">both</span>.</li>
		<li id="Launch:HideCommandLineWindow"><span class="ini-key">HideCommandLineWindow</span> (values: <span class="ini-value">true</span> or <span class="ini-value ini-default">false</span>)<br />If the application produces a command line window which you wish to hide (common in some open source games), you can set this to true to hide it.</li>
	</ul></li>
	<li id="Activate"><span class="ini-head">[Activate]</span><br />This section is for telling the launcher whether or not it should load certain things, for example Java and registry support.<ul>
		<li id="Activate:Registry"><span class="ini-key">Registry</span> (values: <span class="ini-value">true</span> or <span class="ini-value ini-default">false</span>)<br />If the base application uses the registry, set this to true.  <strong>You MUST set this to true if you wish the registry sections to be parsed.</strong> Otherwise they will not be read at all.</li>
		<li id="Activate:Java"><span class="ini-key">Java</span> (values: <span class="ini-value">find</span>, <span class="ini-value">require</span>, or <span class="ini-default">none</span>)<br />If the application can use Java but does not depend on its being available, set this to "find", and a Java Runtime Environment (JRE) will be found if available, and %JAVADIR% will become available as a replacement variable. If the application is completely dependant on Java, set this to "require". Then you may set ProgramExecutable to "javaw.exe" (normal use) or "java.exe" (command line version which may be useful for testing and debugging) and it will use Java. Then mention the JAR file you need in DefaultCommandLineArguments (as -classpath).<br /><strong>Caveat:</strong> With "require", if you can possibly help it, set WaitForProgram or WaitForOtherInstances to false if you use java.exe or javaw.exe.  Otherwise you'll run into problems cleaning up if other Java applications get run, as it'll look for instances of the application, and find javaw.exe, even though it's another application's javaw.exe instance.</li>
	</ul></li>
	<li id="LiveMode"><span class="ini-head">[LiveMode]</span><br />This section is relevant to running the portable application from a read-only location. As specified here, certain things are copied to the local hard drive, and then the application is run, and any things copied locally are deleted. This is called running locally, or "Live mode".<ul>
		<li id="LiveMode:CopyApp"><span class="ini-key">CopyApp</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />When run in Live mode, does the application need to be run from a writable location? If yes, specify "true".</li>
		<li id="LiveMode:CopyData"><span class="ini-key"><s>CopyData</s></span><br />This option has been removed due to issues with the %DATADIRECTORY% replacement variable in file moving. Data will now always be copied. This may change back in the future.</li>
		<!--<li id="LiveMode:CopyData"><span class="ini-key">CopyData</span> (values: <span class="ini-value ini-default">true</span> or <span class="ini-value">false</span>)<br />When run in Live mode, does the application data need to be run from a writable location? If yes, specify "true". It is worthwhile noting that most applications will need settings to be writable. If you have anything in the <span class="ini-head">[RegistryKeys]</span> section with drive letters, or anything in the <span class="ini-head">[DriveLetterUpdate]</span> section, you will need this set to "<span class="ini-value">true</span>".</li>-->
	</ul></li>
</ul>
<p>Below here are the arbitrarily specified entries. For all of these, you may specify as many as are needed, according to the formats specified. For those in the format "<span class="ini-key">1<em>Type</em>=</span><span class="ini-value">something</span>, the numbering system starts at 1, and increments, as in 2, 3, 4. If there is a missing number, any after it will be lost.</p>
<ul>
	<li id="RegistryKeys"><span class="ini-head">[RegistryKeys]</span><br />These are registry keys for which to manage portability. They come in the form <span class="ini-key"><em>file name</em>=</span><span class="ini-value"><em>registry key location</em></span>; the file name is the location of the place where it is saved, which is in Data\settings\<em>file name</em>.reg. If you wish to have drive letters updated inside this, look at <span class="ini-head">[FileDriveLetterUpdate]</span>.<br /><strong>Example:</strong> <span class="ini-key">appname_portable=</span><span class="ini-value">HKEY_CURRENT_USER\Software\AppName</span></li>
	<li id="RegistryValueWrite"><span class="ini-head">[RegistryValueWrite]</span><br />These are registry values to set for running the portable application, useful for things like disabling file association writing. They come in the form <span class="ini-key"><em>HKEY_ET\Cetera\Key\Value</em>=</span><span class="ini-value">REG_<em>TYPE</em>:<em>value</em></span>; the key name is the place in the registry, with the value appended to it after a final slash, and the value is of the form REG_<em>TYPE</em>:<em>value</em>; <em>REG_TYPE:</em> is optional, and defaults to REG_SZ (a string).<br /><strong>Example:</strong> <span class="ini-key">HKEY_CURRENT_USER\Software\AppName\Key\Value=</span><span class="ini-value">REG_DWORD:16</span></li>
	<li id="RegistryCleanupIfEmpty"><span class="ini-head">[RegistryCleanupIfEmpty]</span><br />These are registry keys which get cleaned up after the application has run if they are empty. This is useful if there is a tree which will be left behind, for example, if something stores to HKEY_CURRENT_USER\Software\Publisher\AppName, when AppName is saved, Publisher will still be left, empty. Remove it with a line in here.<br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Publisher</span></li>
	<li id="RegistryCleanupForce"><span class="ini-head">[RegistryCleanupForce]</span><br />These are registry keys which get removed after the application has run. This is useful if there is a tree of useless information which will be left behind, for example, if something stores temporary data to HKEY_CURRENT_USER\Software\AppName\Temp. Remove it with a line in here.<br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Publisher</span></li>
	<li id="RegistryValueBackupDelete"><span class="ini-head">[RegistryValueBackupDelete]</span><br />These are registry values which get backed up before hand and restored later, but any value which may have been set while the portable application is running will be deleted. This can be useful for "dead" values which serve no purpose and so there is no point in saving them anywhere.<br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">HKEY_CURRENT_USER\Software\Publisher\AppName\Value</span></li>
	<li id="FileWriteConfigWrite"><span class="ini-head">[FileWriteConfigWrite]</span><br />For writing arbitrary data to files with lines starting with certain entries. The keys in these sections are <span class="ini-key"><em>N</em>File</span>, <span class="ini-key"><em>N</em>Entry</span> and <span class="ini-key"><em>N</em>Value</span>. The <em>File</em> key is given with things like %DATADIR%\settings\data.conf, specifying the file to write to. <em>Entry</em> should be set to the text to search for at the start of a line. In an INI-type file, this would be "key=", and in an XML file it might be "&nbsp;&nbsp;&nbsp;&nbsp;&lt;config id="something"&gt;"; note that you <strong>must</strong> include any spaces which will be in the file. <em>Value</em> is the value which will be written in the file, the bit which gets placed after the <em>Entry</em>. In XML, you will normally need to close the tag, for example "%DATADIR%\settings<strong>&lt;/config&gt;</strong>"<br /><strong>Substitutions apply for:</strong> File, Value</li>
	<li id="FileWriteINI"><span class="ini-head">[FileWriteINI]</span><br />For writing data to INI files. The keys in these sections are <span class="ini-key"><em>N</em>File</span>, <span class="ini-key"><em>N</em>Section</span>, <span class="ini-key"><em>N</em>Key</span> and <span class="ini-key"><em>N</em>Value</span>. The <em>File</em> key is given with things like %DATADIR%\settings\data.conf, specifying the file to write to. <em>Section</em> should be set to the INI section in which to write the value, and <em>Key</em> is the INI key to write the <em>Value</em> to.<br /><strong>Substitutions apply for:</strong> File, Value</li>
	<li id="FilesMove"><span class="ini-head">[FilesMove]</span><br />These are files for which to manage portability. They come in the form <span class="ini-key"><em>file name</em>=</span><span class="ini-value"><em>target directory</em></span>; the file name is the location of the place where it is saved, relative to the portable data directory.<br /><strong>Substitutions apply.</strong><br /><strong>Example:</strong> <span class="ini-key">settings\file.txt=</span><span class="ini-value">%APPDIR%\AppName</span></li>
	<li id="DirectoriesMove"><span class="ini-head">[DirectoriesMove]</span><br />These are directories for which to manage portability. They come in the form <span class="ini-key"><em>directory</em>=</span><span class="ini-value"><em>target location</em></span>; the directory is the location of the source directory, relative to the portable data directory. The target location includes the directory you want it to go to, so %DATADIRECTORY%\<em>from</em>\*.* gets copied to <em>to</em>\*.*.<br /><strong>Substitutions apply.</strong><strong>Example:</strong> <span class="ini-key">AppName=</span><span class="ini-value">%APPDATA%</span></li>
	<li id="DirectoriesCleanupIfEmpty"><span class="ini-head">[DirectoriesCleanupIfEmpty]</span><br />These are directories which get cleaned up after the application has run if they are empty. This is useful if there is a tree which will be left behind, for example, if something stores to %APPDATA%\Publisher\AppName, when AppName is saved, Publisher will still be left, empty. Remove it with a line in here.<br />The key names here are numbers.<br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">%APPDATA%\Publisher</span><span class="ini-head"></span></li>
	<li id="DirectoriesCleanupForce"><span class="ini-head">[DirectoriesCleanupForce]</span><br />These are directories which get removed after the application has run. This is useful if there is a tree which will be left behind, for example, if something stores temporary data which can be safely deleted in %APPDATA%\AppName\Temp. Remove it with a line in here.<br />The key names here are numbers.<br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">%APPDATA%\Publisher</span><span class="ini-head"></span></li>
	<li id="FileDriveLetterUpdate"><span class="ini-head">[FileDriveLetterUpdate]</span><br />These are files to update the current drive letter in, given relative to the portable data location (Data), not where it may get moved to (see above).<br />The key names here are "Backslash<em>N</em>" and "Forwardslash<em>N</em>" (the numbering of the two is unrelated). Use Backslash if the paths are stored as X:\file, and Forwardslash if they are stored as X:/file, or use both if necessary.<br /><strong>Substitutions apply.</strong><br /><strong>Example:</strong> <span class="ini-key">1=</span><span class="ini-value">something\settings.conf</span></li>
	<li id="Environment"><span class="ini-head">[Environment]</span><br />Environment variables to modify, for example "PATH" or "HOME". The value can start or end with "{&amp;}", which is replaced with the original content. This way you can append or prepend things to PATH. <strong>Substitutions apply.</strong><br /><strong>Example:</strong> <span class="ini-key">PATH=</span><span class="ini-value">%APPDIR%\AppName;{&amp;}</span> (this will prepend the executable's directory to the path.)</li></li>
	<li id="Service"><span class="ini-head">[Service<em>N</em>]</span><br />Services and drivers which are required or recommended by your portable application. There are various keys for each section:<ul>
		<li id="Service:Name"><span class="ini-key">Name</span><br />The service name.</li>
		<li id="Service:Path"><span class="ini-key">Path</span><br />The execution string of the service.</li>
		<li id="Service:Type"><span class="ini-key">Type</span> (values: <span class="ini-value ini-default">service</span>, <span class="ini-value">driver-kernel</span> or <span class="ini-value">driver-file-system</span>)<br />Specify whether you are dealing with a service, a service with desktop interaction or a driver.</li>
		<li id="Service:User"><span class="ini-key">User</span> (values: <span class="ini-value">LocalService</span>, <span class="ini-value">NetworkService</span> or <span class="ini-default">none</span>)<br />If the service needs to run as other than LocalSystem, i.e. as LocalService or NetworkService, specify it here (omit the leading <span class="ini-value">NT AUTHORITY\</span>).</li>
		<li id="Service:Display"><span class="ini-key">Display</span><br />The short display name of the service.</li>
		<li id="Service:Dependencies"><span class="ini-key">Dependencies</span><br />A slash-separated list of dependencies</li>
		<li id="Service:Description"><span class="ini-key">Description</span><br />A description of what the service does for the services control panel applet (this should not be necessary)</li>
		<li id="Service:IfExists"><span class="ini-key">IfExists</span> (values: <span class="ini-value ini-default">skip</span> or <span class="ini-value">replace</span>)<br />If the service already exists, you can either skip it or replace it with the portable version of the service (the original service will be restored afterwards).</li>
	</ul></li>
</ul>
<h4>Substitutions</h4>
<p>(This applies to INI entries marked above as "substitutions apply".)</p>
<ul>
	<li><strong>%DRIVE%</strong> &ndash; the drive letter from which the portable application is running; in Live mode, this is the location of the portable device, <em>not</em> the application or data directory if CopyApp <!--or CopyData are-->is set. e.g. "X:"</li>
	<li><strong>Directory variables:</strong> with all of these variables, after the opening % can come, before the variable name, one of four things: nothing, a forward slash, a double backslash, or <code>java.util.prefs:</code>. This refers to the directory separator to be used; if there is nothing there, it is a backslash. For example, <em>%PORTABLEAPPSDIR%</em> is X:\PortableApps, <em>%/PORTABLEAPPSDIR%</em> is X:/PortableApps, and <em>%\\PORTABLEAPPSDIR%</em> is X:\\PortableApps. If unsure, use the default single backslash. <code>java.util.prefs:</code> is a special prefix for registry keys with Java applications that use java.util.prefs to store their settings. It stores paths like this: <em>%java.util.prefs:PORTABLEAPPSDIR%</em> will become <em>\X:\\\Portable\Apps</em>; all characters other than a colon (:) and lowercase letters are prefixed with a backslash (\).
	<ul>
		<li><strong>%APPDIR%</strong> &ndash; the location of the App directory (not including the AppName bit), e.g. X:\PortableApps\AppNamePortable\App</li>
		<li><strong>%DATADIR%</strong> &ndash; the location of the Data directory (not including the settings or similar bit), e.g. X:\PortableApps\AppNamePortable\Data</li>
		<li><strong>%JAVADIR%</strong> &ndash; the location of the Java Portable directory (not including "bin"), e.g. X:\PortableApps\CommonFiles\Java.  This variable will only be available with <span class="ini-head">[CommonFiles]</span>:<span class="ini-key">Java</span> equal to <span class="ini-value">find</span> or <span class="ini-value">require</span>, but if it is <span class="ini-value">find</span>, it may not exist (for <span class="ini-value">require</span> the launcher will abort if Java is not found).</li>
		<li><strong>%ALLUSERSPROFILE%</strong> &ndash; a local variable for copying to and from, e.g. C:\Documents and Settings\All Users on XP and 2000, C:\ProgramData on Vista.</li>
		<li><strong>%LOCALAPPDATA%</strong> &ndash; a local variable for copying to and from, e.g. C:\Documents and Settings\Username\Local Settings\Application Data on XP and 2000, C:\Users\Username\AppData\Local on Vista.</li>
		<li><strong>%APPDATA%</strong> &ndash; a local variable for copying to and from, e.g. C:\Documents and Settings\Username\Application Data on XP and 2000, C:\Users\Username\AppData\Roaming on Vista.</li>
		<li><strong>%DOCUMENTS%</strong> &ndash; a local variable for copying to and from, e.g. C:\Documents and Settings\Username\My Documents on XP and 2000, C:\Users\Username\Documentson Vista.</li>
		<li><strong>%TEMP%</strong> &ndash; the temporary directory which the application will be given. If a contained temporary directory is assigned, this will be the assigned one.</li>
		<li><strong>%PORTABLEAPPSDOCUMENTSDIR%</strong> &ndash; the PortableApps.com Documents directory, e.g X:\Documents</li>
		<li><strong>%PORTABLEAPPSPICTURESDIR%</strong> &ndash; the PortableApps.com Pictures directory, e.g X:\Documents\Pictures</li>
		<li><strong>%PORTABLEAPPSMUSICDIR%</strong> &ndash; the PortableApps.com Music directory, e.g X:\Documents\Music</li>
		<li><strong>%PORTABLEAPPSVIDEOSDIR%</strong> &ndash; the PortableApps.com Videos directory, e.g X:\Documents\Videos</li>
		<li><strong>%PORTABLEAPPSDIR%</strong> &ndash; the PortableApps.com applications directory, e.g. X:\PortableApps.</li>
	</ul></li>
	<li><strong>Language variables:</strong> these variables are for language switching.  It's not highly optimised yet, and it's not as powerful as it should be eventually, but it's a start.<ul>
		<li><strong>%LANGCODE%</strong> &ndash; e.g. "en-us", "pt", "pt-br"</li>
		<li><strong>%LANGCODE2%</strong> &ndash; e.g. "en", "pt", "pt"</li>
		<li><strong>%LANGCODE3%</strong> &ndash; e.g. "eng", "por", "por"</li>
		<li><strong>%LANGGLIBC%</strong> &ndash; e.g. "en_US", "pt", "pt_BR"</li>
		<li><strong>%LANGID%</strong> &ndash; e.g. "1033", "2070", "1046"</li>
		<li><strong>%LANGWINNAME%</strong> &ndash; e.g. "LANG_ENGLISH", "LANG_PORTUGUESE", "LANG_PORTUGUESEBR"</li>
	</ul></li>
</ul>
<h3>Sample INI launcher configuration</h3>
<h4>Sample 7-Zip launcher</h4>
<p>7-Zip stores its settings in the registry, in HKEY_CURRENT_USER\Software\7-Zip. In previous releases of 7-Zip Portable, it has stored this in Data\settings\7zip_portable.reg. 7-Zip itself can be run from a read-only location.</p>
<p>Here is a fully functional sample launcher file, configured correctly for 7-Zip:</p>
<pre><span class="ini-head">[Launch]</span>
<span class="ini-key">ProgramExecutable=</span><span class="ini-value">7-Zip\7zFM.exe</span>

<span class="ini-head">[Activate]</span>
<span class="ini-key">Registry=</span><span class="ini-value">true</span>

<span class="ini-head">[RegistryKeys]</span>
<span class="ini-key">7zip_portable=</span><span class="ini-value">HKEY_CURRENT_USER\Software\7-Zip</span>
</pre>
<p>To outline what this actually does: in the registry, <span class="ini-key">HKEY_CURRENT_USER\Software\7-Zip</span> is backed up if necessary, and the contents of Data\settings\<span class="ini-key">7zip_portable</span>.reg are inserted into the registry, after updating the drive letter. Then App\<span class="ini-key">7-Zip</span>\<span class="ini-key">7zFM.exe</span> is run. After it is closed, the 7-Zip registry key is stored and deleted, and the backup of local 7-Zip settings is restored if it existed.</p>
<h4>Sample Code::Blocks launcher</h4>
<p>Code::Blocks stores its settings in the local user's application data directory, in %APPDATA%\codeblocks. However, this cannot just be redirected, as it also depends on %USERPROFILE%, which after testing has been demonstrated to not redirect safely. Thus data must be moved back and forth for running portably. Code::Blocks itself can be run from a read-only location.</p>
<p>Here is a fully functional sample launcher file, configured correctly for Code::Blocks:</p>
<pre><span class="ini-head">[Launch]</span>
<span class="ini-key">ProgramExecutable=</span><span class="ini-value">CodeBlocks\codeblocks.exe</span>
<span class="ini-key">DefaultCommandLineArguments=</span><span class="ini-value">--no-check-associations --no-dde --no-splash-screen</span>

<!--<span class="ini-head">[LiveMode]</span>
<span class="ini-key">CopyData=</span><span class="ini-value">true</span>

--><span class="ini-head">[DirectoriesMove]</span>
<span class="ini-key">personalities=</span><span class="ini-value">%APPDATA%\codeblocks\personalities</span>
<span class="ini-key">UserTemplates=</span><span class="ini-value">%APPDATA%\codeblocks\UserTemplates</span>
<span class="ini-key">share=</span><span class="ini-value">%APPDATA%\codeblocks\share</span>

<span class="ini-head">[DirectoriesCleanupIfEmpty]</span>
<span class="ini-key">1=</span><span class="ini-value">%APPDATA%\codeblocks</span>

<span class="ini-head">[DriveLetterUpdate]</span>
<span class="ini-key">1=</span><span class="ini-value">%DATADIR%\personalities\default.conf</span>
</pre>
<p>To outline what this actually does: <span class="ini-key">%APPDATA%\codeblocks</span>\<span class="ini-key">personalities</span> is backed up if necessary, and the contents of Data\<span class="ini-key">personalities</span> are copied to <span class="ini-key">%APPDATA%\codeblocks</span>\<span class="ini-key">personalities</span>, after updating the drive letter in <span class="ini-key">Data\personalities\default.conf</span>. In the same way, the <span class="ini-key">UserTemplates</span> and <span class="ini-key">share</span> directories are backed up and copied. Then App\<span class="ini-key">CodeBlocks</span>\<span class="ini-key">codeblocks.exe</span> is run. After it is closed, the APPDATA directories are copied to the Code::Blocks Portable Data directory and deleted, and the backup of local Code::Blocks settings is restored if it existed. At the end, if <span class="ini-key">%APPDATA%\codeblocks</span> is empty, it is removed.</p>

<h3>A note on Java applications</h3>
<p>There are a few different ways of doing Java applications.</p>
<ul>
	<li><strong>Eclipse-based applications:</strong> these seem to normally accept a command-line argument to the executable included, to specify the Java location to use. Try setting <span class="ini-key">DefaultCommandLineArguments</span> to <span class="ini-value">-vm "%JAVADIR%\bin"</span>.</li>
	<li><strong>Launch4J-based applications (seems to be most apps):</strong> these apps run an executable, which discovers Java from the registry, and run something which creates an executable in the JRE's directory, in a subdirectory <code>launch4j-tmp</code>, which will run the java application.  Try running the base application (with a local JRE installation) and then use a program such as Microsoft/SysInternals Process Explorer to look at the command line arguments which it then gets started with. In Process Explorer, right-click on the executable and click "Properties", and copy the execution string.</li>
	<li><strong>Other:</strong> panic! ;-) If you come up with any other techniques and/or circumstances where other techniques would be better, please suggest them.</li>
</ul>
</div>
<div class="footer"></div>
</body>
</html>
